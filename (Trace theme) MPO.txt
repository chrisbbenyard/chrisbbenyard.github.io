<!----- 
Multiple Product Options for Big Cartel
Author: Theme Fiend
Theme: Trace
----->
<div><section class="scripts-and-styles-mpo">
{% assign: License_Key = "XXXX-XXXX-XXXX-XXXX" %} {{ Note: Replace with the License Key you received from your purchase }}
{% assign: First_Option_Group_Name = "Color" %}
{% assign: Second_Option_Group_Name = "Size" %}
{% assign: First_Option_Group_Type = "Tabs" %} {{ Options: "Tabs" or "Dropdown" }}
{% assign: Option_Name_Seperator = " / " %}

<script>
optGroups = [
	{
      option_name: "Example Color 1",
      swatch: "#cccccc",
      product_slug: "example-product",
	},	
	{
      option_name: "Example Color 2",
      swatch: "#000000", 
      product_slug: "example-product",
	},		
]
</script>
<!----- DO NOT EDIT CODE BELOW!! ----->
{% assign: Products_Grid_Zone = "ul.product-list:not(.collection-list)" %}{% assign: Cart_Zone = ".cart-items" %}{% assign: Image_Gallery_Zone = ".product-images" %}{% assign: Product_Form_Zone = "form[action*=cart]:first" %}
{% assign: Products_per_Row = 4 %}{% assign: ppr = Products_per_Row %}{% capture p_pr %}{% if ppr == 2 %}6{% elsif ppr == 3 %}4{% elsif ppr == 4 %}3{% endif %}{% endcapture %}    
<script data-theme="Trace" id="product_images_template" type="text/html"><% for(var x = 0; x < products.length; x++){ %> <% if (products[x].id == "{{ product.id }}") { %><div class="product-image-gallery"><li class="featured" <% if (products[x].images.length> 1) { %>style="width:100%" <% } %>> <% for(var z = 0; z < 1; z++){ %> <a href="<%= products[x].images[z] %>"><img src="<%= products[x].images[z] %>" alt="Image of <%= products[x].title %>" /></a> <% } %></li> <% if (products[x].images.length > 1) { %><ul id="product_thumbnails" class="product-gallery"> <% for(var z = 0; z < products[x].images.length; z++){ %><li class="thumbnail"><a href="<%= products[x].images[z] %>" onclick="return false;"><img src="<%= products[x].images[z] %>" alt="Image of <%= products[x].title %>" /></a></li> <% } %></ul> <% } %></div> <% } %> <% } %></script>
<script data-theme="Trace" id="multiple_product_options_template" type="text/html"><% for(var x = 0; x < products.length; x++){ %> <% if (products[x].id == current_product_id) { %><div class="selector"><div class="option-title">{{ First_Option_Group_Name }}</div><% var uniqueNames = []; %><div class="parent-options option-group" data-product-slug="{{ product.url | remove: '/product/' }}"> <% if (selection_type == "Dropdown") { %><div class="select"><select name="cart[add][id]" data-name="{{ First_Option_Group_Name | lowercase }}"><option disabled="disabled" selected="selected">Choose {{ First_Option_Group_Name | lowercase }}</option> <% for(var a = 0; a < products[x].product_options.length; a++){ %> <% if(uniqueNames.indexOf(products[x].product_options[a].title) === -1){ %><option data-title="<%=products[x].product_options[a].tag %>" data-product-image="" data-index="<%= uniqueNames.push(products[x].product_options[a].title)%>" id="<%=products[x].product_options[a].value %>" value="<% if (products[x].product_options[a].relationship == "parent") { %><%=products[x].product_options[a].value %><% } else { %><%=products[x].product_options[a].option_id %><% } %>"><%=products[x].product_options[a].title %></option> <% } %> <% } %><% for ( var a = 0; a < products[x].product_options.length; a++ ) { %> <% if(uniqueNames.indexOf(products[x].product_options[a].title) === -1){ %> <%= uniqueNames[a] %> <% } %> <% } %> </select><div class="arrow-holder"> <svg width="10" height="6" viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg"><path d="M9.852 1.536c.2-.19.2-.496 0-.684L9.135.17c-.197-.19-.518-.19-.715 0L5.016 3.463 1.582.142c-.2-.19-.52-.19-.717 0L.148.825c-.197.188-.197.494 0 .684l4.508 4.35c.2.187.52.187.717 0l4.48-4.324z"></path></svg></div></div> <% } else { %><% for(var a = 0; a < products[x].product_options.length; a++){ %> <% if(uniqueNames.indexOf(products[x].product_options[a].title) === -1){ %><li data-index="<%= uniqueNames.push(products[x].product_options[a].title)%>"><input data-title="<%=products[x].product_options[a].tag %>" type="radio" id="<%=products[x].product_options[a].value %>" name="<% if (products[x].product_options[a].relationship == "parent") { %>parent_option<% } else { %>cart[add][id]<% } %>" value="<% if (products[x].product_options[a].relationship == "parent") { %><%=products[x].product_options[a].value %><% } else { %><%=products[x].product_options[a].option_id %><% } %>"><label data-swatch="<%=products[x].product_options[a].title %>" for="<%=products[x].product_options[a].value %>"><span data-swatch="<%=products[x].product_options[a].title %>" class="color-swatch"></span><span><%=products[x].product_options[a].title %></span></label></li> <% } %> <% } %><% for ( var a = 0; a < products[x].product_options.length; a++ ) { %> <% if(uniqueNames.indexOf(products[x].product_options[a].title) === -1){ %> <%= uniqueNames[a] %> <% } %> <% } %></ul> <% } %></div></div> <% if (products[x].product_options[0].original_title.indexOf(" / ") > -1) { %><div class="sub-option-title">{{ Second_Option_Group_Name | lowercase }}</div><div class="select sub-options"><select name="cart[add][id]"><option disabled="disabled" selected="selected">Choose {{ Second_Option_Group_Name | lowercase }}</option></select><div class="arrow-holder"> <svg width="10" height="6" viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg"><path d="M9.852 1.536c.2-.19.2-.496 0-.684L9.135.17c-.197-.19-.518-.19-.715 0L5.016 3.463 1.582.142c-.2-.19-.52-.19-.717 0L.148.825c-.197.188-.197.494 0 .684l4.508 4.35c.2.187.52.187.717 0l4.48-4.324z"></path></svg></div></div> <% } %> <% } %> <% } %>	</script>
<div id="color_swatch_styles"></div>
<script id="color_swatch_styles_template" type="text/html"><style class="stylesheet" type="text/css">.page-loader{opacity: .75}.extra-image+a[href*=product_images]{display:none}.fadeIn{min-height:250px;transition:.5s ease all;transition-delay: .5s}<% for ( var a = 0;a < optGroups.length;a++ ){ %> <% if (optGroups[a].product_slug){ %>.parent-options[data-product-slug="<%=optGroups[a].product_slug%>"]<% }%>.color-swatch[data-swatch="<%=optGroups[a].option_name%>"]{<% if (optGroups[a].swatch.indexOf("#")>-1){ %>background-color:<%=optGroups[a].swatch %><% }%> <% if (optGroups[a].swatch.indexOf(".")>-1){ %>background-image:url(<%=optGroups[a].swatch %>);<% }%>}<% }%></style></script>
<div id="color_swatch_styles"></div>
<script data-theme="Trace" id="new_products_grid_template" type="text/html">{%if page.full_url contains'/products'%}<%for(var x=0;x<products.length;x++){ %>{%else%}<%for(var x=0;x<products.length;x++){ %>{%endif%}{%if page.full_url contains'/product/'%}<%for(var y=0;y<products[x].categories.length;y++){ %><%if(products[x].categories[y].value=="{% for category in product.categories limit: 1 %}{{ category.permalink }}{% endfor %}"){ %>{%endif%}<li class="fade-in product <% if (products[x].onSale == "true") { %>sale <% } else if (products[x].status == "coming-soon") { %> coming-soon<% } else if (products[x].status == "sold-out") { %> sold-out<% } %>"><a class="product-link"href="<%= products[x].url %>"><%for(var z=0;z<products[x].images.length;z++){ %><img class="product-image"data-slug="<%= products[x].url.replace("/product/", "") %>"alt="Image of <%= products[x].title %>"src="<%= products[x].images[z] %>"data-image="<%= products[x].images[z] %>"><% }%><div class="product-info"><div class="product-name"><%=products[x].title%></div><div class="product-price-status"><span class="product-price"><%=products[x].defaultPrice%></span><%if(products[x].onSale=="true"||products[x].status=="sold-out"||products[x].status=="coming-soon"){ %><span class="product-status">-<%if(products[x].onSale=="true"){ %>On sale<% }else if(products[x].status=="sold-out"){ %>Sold out<% }else if(products[x].status=="coming-soon"){ %>Coming soon<% }%></span><% }%></div></div></a><div class="product_options_list parent-options"data-product-slug="<%= products[x].url.replace("/product/", "") %>"><div class="pol-inner"><%var uniqueNames=[];%><%for(var a=0;a<products[x].product_options.length;a++){ %><%if(uniqueNames.indexOf(products[x].product_options[a].title)===-1){ %><span data-index="<%= uniqueNames.push(products[x].product_options[a].title) %>"><input data-title="<%= products[x].product_options[a].tag %>"type="radio"id="<%= products[x].product_options[a].value %>"name="first_group"value="<%= products[x].product_options[a].value %>"><label data-slug="<%= products[x].url.replace("/product/", "") %>"data-tag="<%= products[x].product_options[a].tag %>"for="<%= products[x].product_options[a].value %>"><a href="<%= products[x].url %>?<%= first_option_group_name.toLowerCase() %>=<%= products[x].product_options[a].title.replace(" ", "%20").replace("/", "-") %>"><span data-swatch="<%= products[x].product_options[a].title %>"class="color-swatch"></span><span class="label-text"><%=products[x].product_options[a].title%></span></a></label></span><% }%><% }%><%for(var a=0;a<products[x].product_options.length;a++){ %><%if(uniqueNames.indexOf(products[x].product_options[a].title)===-1){ %><%=uniqueNames[a]%><% }%><% }%></div></div></li><% }%>{%if page.full_url contains'/product/'%}<% }%><% }%>{%endif%}</script>
<script type="text/html" id="color_swatch_styles_template"><style class="stylesheet" type="text/css">.extra-image+a[href*=product_images]{display:none}.fadeIn{min-height:250px;transition:.5s ease all;transition-delay: .5s}<% for ( var a = 0;a < optGroups.length;a++ ){ %> <% if (optGroups[a].product_slug){ %>.parent-options[data-product-slug="<%=optGroups[a].product_slug%>"]<% }%>.color-swatch[data-swatch="<%=optGroups[a].option_name%>"]{<% if (optGroups[a].swatch.indexOf("#")>-1){ %>background-color:<%=optGroups[a].swatch %><% }%> <% if (optGroups[a].swatch.indexOf(".")>-1){ %>background-image:url(<%=optGroups[a].swatch %>);<% }%>}<% }%></style></script>	
<script data-theme="Trace" id="new_cart_template" type="text/html"><%for(var x=0;x<items.length;x++){ %><li class="cart-item"data-product-id="<%= items[x].id %>"data-cart-id="<%= items[x].id %>"><div class="item-image-details"><a class="item-image"href="<%= items[x].url %>"title="View <%=items[x].title%>"style="background-image:url('<%= items[x].images[0] %>');"><img class="current-image"src="<%= items[x].images[0] %>"></a><div class="item-details"><a class="item-product-link"title="View <%=items[x].title%>"href="<%= items[x].url %>"><span class="item-details-name"><%=items[x].title%></span><span class="item-details-option"><%=items[x].current_option%></span><span class="item-details-price"><%=items[x].unit_price%></span></a></div><div class="item_images"><%for(var z=0;z<items[x].images.length;z++){ %><img src="<%= items[x].images[z] %>"><% }%></div></div><div class="item-quantity-holder"data-cart-id="<%= items[x].id %>"><button class="decrease-qty-button qty"type="button"data-func="minus"><svg viewBox="0 0 20 20"><path d="M5 9h10v2H5z"/><path d="M5 9h10v2H5z"/></svg></button><input type="text"name="cart[update][<%= items[x].id %>]"id=""value="<%= items[x].quantity %>"class="quantity"autocomplete="off"><button class="increase-qty-button qty"type="button"data-func="plus"><svg viewBox="0 0 20 20"><path d="M11 5H9v4H5v2h4v4h2v-4h4V9h-4z"/></svg></button></div><div class="price"><%=items[x].unit_price%></div><div class="swatch-options"><%var uniqueNames=[];%><%for(var a=0;a<items[x].product_options.length;a++){ %><%if(uniqueNames.indexOf(items[x].product_options[a].title)===-1){ %><span data-index="<%= uniqueNames.push(items[x].product_options[a].title) %>"><input data-title="<%= items[x].product_options[a].tag %>"type="radio"id="<%= items[x].product_options[a].value %>"value="<%= items[x].product_options[a].value %>"><label data-item-url="<%= items[x].url %>"data-slug="<%= items[x].url.replace("/product/", "") %>"data-title="<%= items[x].product_options[a].tag %>"data-tag="<%= items[x].product_options[a].tag %>"for="<%= items[x].product_options[a].value %>"><span data-swatch="<%= items[x].product_options[a].title %>"class="color-swatch"></span><span class="label-text"><%=items[x].product_options[a].title%></span></label></span><% }%><% }%><%for(var a=0;a<items[x].product_options.length;a++){ %><%if(uniqueNames.indexOf(items[x].product_options[a].title)===-1){ %><%=uniqueNames[a]%><% }%><% }%></div></li><% }%></script>
<link rel="stylesheet" type="text/css" href="https://s3.amazonaws.com/themefiend/multiple-product-options/mpo_styles.css"> <script type="text/javascript" data-script="mpo" src="https://s3.amazonaws.com/themefiend/multiple-product-options/mpo_script.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-zoom/1.7.20/jquery.zoom.min.js"></script>
<script type="text/javascript">var splitter = "<%";
!function(){var t={};this.tmpl=function n(p,i){var e=/\W/.test(p)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+p.replace(/[\r\t\n]/g," ").split(splitter).join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):t[p]=t[p]||n(document.getElementById(p).innerHTML);return i?e(i):e}}();	
{% if page.full_url contains '/product/' %}var productData = { "selection_type": "{{ First_Option_Group_Type }}", "first_option_group_name": "{{ First_Option_Group_Name }}", "current_product_id": "{{ product.id }}", "products": [ { "title": "{{ product.name }}", "id": "{{ product.id }}", "images": [{% for image in product.images %}"{{ image | product_image_url | constrain: '900'}}",{% endfor %}], "url": "{{ product.url }}", "maxPrice": "{{ product.max_price | money_with_sign | strip_html }}", "defaultPrice": "{{ product.default_price | money_with_sign | strip_html }}", "maxPriceVal": {{ product.max_price }}, "defaultPriceVal": {{ product.default_price }}, "status": "{{ product.status }}", "onSale": "{{ product.on_sale }}", "index": "{{ forloop.index }}", "ppr": "{{ p_pr }}", "creationDate": "{{ product.created_at | date: '%m-%d-%y' }}", "categories":[{% for category in product.categories %}{"value": "{{ category.permalink }}"},{% endfor %}], "product_options":[ {% for option in product.options %} {% assign: variant_option = option.name | split: Option_Name_Seperator %} {% capture optionName %}{{ variant_option[0] }} / {{ variant_option[1] }}{% endcapture %} {"title": "{{ variant_option[0] }}", "original_title": "{{ option.name }}", "option_id": "{{ option.id }}", "product_id": "{{ product.id }}", "stock_quantity": "{% if option.quantity == 0 %}sold-out{% else %}{{ option.quantity }}{% endif %}", "stock_status": "{% if option.quantity == 0 %}sold-out{% else %}in-stock{% endif %}", "tag": "{{ variant_option[0] | replace: ' ', '+' | replace: '/', '-' }}", "relationship": {% if option.name contains Option_Name_Seperator %}"parent"{% else %}null{% endif %}, "value": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "options": [ {% for option in product.options %}{% if option.name == optionName %}{"title": "{{ option.name | remove: variant_option[0] | remove: Option_Name_Seperator }}", "stock_quantity": "{{ option.quantity }}", "id": "{{ option.id }}", "product_id": "{{ product.id }}", "parent": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "price":"{{ option.price | money: 'sign' | strip_html }}", "stock_status":"{% if option.quantity == 0 %}sold-out{% else %}in-stock{% endif %}"},{% endif %}{% endfor %} ]}, {% endfor %} ] }, ] };(function($) { if ($('span[data-swatch]').css('background-color') != 'rgba(0, 0, 0, 0)' && $('span[data-swatch]').css('background-image') != 'none') { var swatchStyles = document.getElementById("color_swatch_styles"); swatchStyles.innerHTML = tmpl("color_swatch_styles_template", optGroups); $('#multiple_product_options li label').css('border-radius', '100%'); } var imageGallery = document.querySelector('{{ Image_Gallery_Zone }}'); imageGallery.innerHTML = tmpl('product_images_template', productData); $("{{ Product_Form_Zone }}").prepend("<div id='multiple_product_options' data-mpo-id='{{ product.id }}_id'>" + tmpl('multiple_product_options_template', productData) + "</div>"); $(".select:last").remove(); $(document).ready(function() { $('.select select:not(:has(svg))').append('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 7.6" enable-background="new 0 0 15 7.6"><path d="M15 1.1l-7.5 6.5-7.5-6.3 1-1.2 6.5 5.5 6.5-5.6z"></path></svg>'); $('.relpro_inner').find("div.product").slice({{ ppr }},{{ ppr | plus: 1}}).remove(); var currentImage = $(".featured img").attr("src"); $('.featured').zoom({url: currentImage}); for ( var a = 0; a < optGroups.length; a++ ) {$("#multiple_product_options:first span.color-swatch:not([data-product-image])").on('click', function(){ $(".product-image-gallery:first .featured .extra-image, .extra-image-gallery").remove(); });if (optGroups[a].product_image) { $('span[data-swatch="' + optGroups[a].option_name + '"], input[data-title="' + optGroups[a].option_name + '"], option[data-title="' + optGroups[a].option_name + '"]').attr('data-product-image', optGroups[a].product_image.replace(',','')); }$('#multiple_product_options:first [data-product-slug="' + optGroups[a].product_slug + '"] span[data-product-image][data-swatch="' + optGroups[a].option_name + '"]').on("click", function() { var prodImg = $(this).attr('data-product-image'); $(".product-image-gallery:first .featured:not(:has(.extra-image))").prepend('<div class="extra-image"></div>'); $(".product-image-gallery:first .featured .extra-image").html('<a class="fadeIn cboxElement" href="' + prodImg + '"><img src="' + prodImg + '"></a>'); }); } }); $('span[data-swatch]').each(function() { if ($(this).css('background-color') == 'rgba(0, 0, 0, 0)' && $(this).css('background-image') == 'none') { $(this).remove(); } }); })(jQuery);{% endif %}
var cartData = { "first_option_group_name": "{{ First_Option_Group_Name }}", "items": [ {% for item in cart.items %} { "title": "{{ item.product.name }}", "id": "{{ item.id }}", "images": [{% for image in item.product.images %}"{{ image | product_image_url | constrain: '900'}}",{% endfor %}], "url": "{{ item.product.url }}", "unit_price": "{{ item.unit_price | money_with_sign | strip_html }}", "quantity": "{{ item.quantity }}", "total_price": "{{ item.price | money_with_sign | strip_html }}", "stock_status": "{{ item.product.status }}", "onSale": "{{ item.product.on_sale }}", "index": "{{ forloop.index }}", "current_option": "{{ item.option.name }}", "product_options":[ {% for option in item.product.options %} {% assign: variant_option = item.option.name | split: ' / ' %} {% capture optionName %}{{ variant_option[0] }} / {{ variant_option[1] }}{% endcapture %} {"title": "{{ variant_option[0] }}", "tag": "{{ variant_option[0] | replace: ' ', '+' | replace: '/', '-' }}", "relationship": {% if item.option.name contains ' / ' %}"parent"{% else %}null{% endif %}, "value": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "options": [ {% if item.option.name == optionName %}{"title": "{{ item.option.name | remove: variant_option[0] | remove: ' / ' }}", "id": "{{ item.option.id }}", "parent": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "price":"{{ item.option.price | money: 'sign' | strip_html }}"},{% endif %} ]}, {% endfor %} ] }, {% endfor %} ] }; var swatchStyles = document.getElementById("color_swatch_styles"); swatchStyles.innerHTML = tmpl("color_swatch_styles_template", optGroups);(function($) { var cartLoop = $('{{ Cart_Zone }}'); cartLoop.html(tmpl('new_cart_template', cartData)); $(".swatch-options label[data-title]").each(function(){ $(this).click(function(){ var selectedOption = $(this).attr("data-title"); var productId = $(this).parents("li").attr("data-product-id"); var productUrl = $(this).attr("data-item-url"); $("li[data-product-id=" + productId + "] .item_images img[src*='_" + selectedOption + "_']:first, li[data-cart-id=" + productId + "] .item_images img[src*='_" + selectedOption + "_']:first").each(function() { var currentOptionImage = $(this).attr('src'); $("li[data-product-id=" + productId + "] .current-image, li[data-cart-id=" + productId + "] .current-image").attr('src', currentOptionImage).parents("a").attr("href", productUrl + "?" + cartData.first_option_group_name.toLowerCase() + "=" + selectedOption.replace("+", "%20")); }); }); }); $(document).ready(function() { $("a.remove-btn").click(function() { var product_id = $(this).attr('data-product-id'); Cart.removeItem(product_id, function(cart) { $("button.update_btn").trigger('click'); }); }); $("#choose-country select").on('change', function() { $("button.update_btn").trigger('click'); }); $(".swatch-options label[data-title]").trigger("click");}); $('span[data-swatch]').each(function() { if ($(this).css('background-color') == 'rgba(0, 0, 0, 0)' && $(this).css('background-image') == 'none') { $(this).remove(); } }); })(jQuery);
</script><div id="color_swatch_styles"></div>
<script id="color_swatch_styles_template" type="text/html"><style class="stylesheet" type="text/css">.extra-image+a[href*=product_images]{display:none}.fadeIn{min-height:250px;transition:.5s ease all;transition-delay: .5s}<% for ( var a = 0;a < optGroups.length;a++ ){ %> <% if (optGroups[a].product_slug){ %>.parent-options[data-product-slug="<%=optGroups[a].product_slug%>"]<% }%>.color-swatch[data-swatch="<%=optGroups[a].option_name%>"]{<% if (optGroups[a].swatch.indexOf("#")>-1){ %>background-color:<%=optGroups[a].swatch %><% }%> <% if (optGroups[a].swatch.indexOf(".")>-1){ %>background-image:url(<%=optGroups[a].swatch %>);<% }%>}<% }%></style></script>
</section></div>{% unless page.full_url contains '/cart' %}<script>(function($) { var productGridData = { "selection_type": "{{ First_Option_Group_Type }}", "first_option_group_name": "{{ First_Option_Group_Name }}", {% if page.full_url contains "/product/" %}"current_product_id": "{{ product.id }}",{% endif %} "products": [ {% if page.full_url contains '/product/' %} {% for product in products.all %} {% unless product.id == currentProduct %} { "title": "{{ product.name }}", "images": [{% for image in product.images %}"{{ image | product_image_url | constrain: '900'}}",{% endfor %}], "url": "{{ product.url }}", "maxPrice": "{{ product.max_price | money_with_sign | strip_html }}", "defaultPrice": "{{ product.default_price | money_with_sign | strip_html }}", "maxPriceVal": {{ product.max_price | money }}, "defaultPriceVal": {{ product.default_price | money }}, "status": "{{ product.status }}", "onSale": "{{ product.on_sale }}", "index": "{{ forloop.index }}", "ppr": "{{ p_pr }}", "creationDate": "{{ product.created_at | date: '%m-%d-%y' }}", "categories":[{% for category in product.categories %}{"value": "{{ category.permalink }}"},{% endfor %}], "product_options":[ {% for option in product.options %} {% assign: variant_option = option.name | split: Option_Name_Seperator %} {% capture optionName %}{{ variant_option[0] }} / {{ variant_option[1] }}{% endcapture %} {"title": "{{ variant_option[0] }}", "tag": "{{ variant_option[0] | replace: ' ', '+' | replace: '/', '-' }}", "relationship": {% if option.name contains Option_Name_Seperator %}"parent"{% else %}null{% endif %}, "value": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "options": [ {% for option in product.options %}{% if option.name == optionName %}{"title": "{{ option.name | remove: variant_option[0] | remove: Option_Name_Seperator }}", "id": "{{ option.id }}", "parent": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "price":"{{ option.price | money: 'sign' | strip_html }}", "status":"{% if option.quantity == 0 %}sold-out{% else %}in-stock{% endif %}"},{% endif %}{% endfor %} ]}, {% endfor %} ] }, {% endunless %} {% endfor %} {% endif %} {% if page.full_url contains '/products' or page.full_url contains '/category' or page.permalink == 'home' %} {% for product in products.current %} { "title": "{{ product.name }}", "images": [{% for image in product.images %}"{{ image | product_image_url | constrain: '900'}}",{% endfor %}], "url": "{{ product.url }}", "maxPrice": "{{ product.max_price | money_with_sign | strip_html }}", "defaultPrice": "{{ product.default_price | money_with_sign | strip_html }}", "maxPriceVal": {{ product.max_price | money }}, "defaultPriceVal": {{ product.default_price | money }}, "status": "{{ product.status }}", "onSale": "{{ product.on_sale }}", "index": "{{ forloop.index }}", "ppr": "{{ p_pr }}", "creationDate": "{{ product.created_at | date: '%m-%d-%y' }}", "categories":[{% for category in product.categories %}{"value": "{{ category.permalink }}"},{% endfor %}], "product_options":[ {% for option in product.options %} {% assign: variant_option = option.name | split: Option_Name_Seperator %} {% capture optionName %}{{ variant_option[0] }} / {{ variant_option[1] }}{% endcapture %} {"title": "{{ variant_option[0] }}", "tag": "{{ variant_option[0] | replace: ' ', '+' | replace: '/', '-' }}", "relationship": {% if option.name contains Option_Name_Seperator %}"parent"{% else %}null{% endif %}, "value": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "options": [ {% for option in product.options %}{% if option.name == optionName %}{"title": "{{ option.name | remove: variant_option[0] | remove: Option_Name_Seperator }}", "id": "{{ option.id }}", "parent": "{{ variant_option[0] | downcase | escape | replace: ' ', '-'}}", "price":"{{ option.price | money: 'sign' | strip_html }}", "status":"{% if option.quantity == 0 %}sold-out{% else %}in-stock{% endif %}"},{% endif %}{% endfor %} ]}, {% endfor %} ] }, {% endfor %} {% endif %} ] }; var swatchStyles = document.getElementById("color_swatch_styles"); swatchStyles.innerHTML = tmpl("color_swatch_styles_template", optGroups);  $(document).ready(function() { $(".pol-inner:not(:has(span[data-swatch]))").remove(); }); $('span[data-swatch]').each(function() { if ($(this).css('background-color') == 'rgba(0, 0, 0, 0)' && $(this).css('background-image') == 'none') { $(this).remove(); } }); var prodLoop = $('{{ Products_Grid_Zone }}'); prodLoop.html(tmpl('new_products_grid_template', productGridData)); })(jQuery);</script>{% endunless %}
<script type="text/javascript">var LicenseKey = "{{ License_Key }}"; var shopURL = "{{ store.url }}";</script>
<style type="text/css">.cart-items a.item-image{position:relative}ul#product_thumbnails li.thumbnail{display:inline-block;width:20%;padding:0 10px;box-sizing:border-box}ul#product_thumbnails{padding:0;font-size:0;margin:10px -10px}.product-image-gallery li img{width:100%}.product-image-gallery li img[role=presentation]{display:none!important}#multiple_product_options li label{border:none}.cart-items .item-image img {max-width: 100%;position: absolute;left: 0%;z-index: 0;min-height: 100%}.cart-items a.item-image {overflow: hidden}span.item-delete {z-index: 1}.selector {margin-bottom: 25px}.product-list .product .product-link .product-image:not(:first-of-type) {display: none}.product_options_list.parent-options {position: absolute}.pol-inner input {position: absolute;left: -9999px}.product_options_list label {margin-left: 10px}.color-swatch {width: 20px;height: 20px;border-radius: 100%;border: none}</style>
